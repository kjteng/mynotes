<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <title>Using TJsonTools object</title>
  </head>
  <body style="                               background-color: #ffffcc;">
    <p></p>
    <h1><u><b>Using TJsonTools object</b></u> <br>
    </h1>
    <p></p>
    <p><b>Introduction</b><br>
      TJsonTools is a thirdpary class that can be used to access/manipulate json
      data. I prefer use this component instead of fcl-json (come with the
      freepascal installation) because it is simpler and reasonably fast. In
      addition, all the related code in stored in ONE pascal unit, i.e.
      JSonTools.pas.</p>
    <p> <b>I. Getting started </b></p>
    <!--
    <p style="border-width:1px; border-style:solid; padding: 1em;"> var js1: TJSonNode; <br>      js1 := TJSonNode.Create; </p>    -->
    <ol>
      <li> Add JsonTools to uses clause </li>
      <li>Declare an TJSonNode variable: <br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: #990000;">var js1:
          TJSonNode;</span>&nbsp; </li>
      <li>Create/initialise JsonNode object: <br>
        &nbsp;&nbsp;&nbsp; &nbsp;<span style="color: #990000;"> js1 :=
          TJSonNode.Create;</span></li>
      <li>Load json data by one of the following methods: <br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (i)&nbsp; Assignment of json string e.g.
        js1.AsJson :='[10, 20, 30]' <br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (ii) Loading data from file, eg
        js1.LoadFromFile('data.txt') </li>
    </ol>
    <p><b><br>
      </b></p>
    <p><b>II. Read node value</b></p>
    <p>In JsonTool, each piece of data in a node is stored in a child node.<br>
      A node in json may be:<br>
      &nbsp;&nbsp;&nbsp; (i)&nbsp; container type i.e. array or object type<br>
      &nbsp;&nbsp;&nbsp; (ii) based type i.e. Number, string, boolean, or null
      type</p>
    We can access the value of a node using value property of a node<br>
    <p> As the each element of a container node is stored in a separate child
      node, it shall be accessed via Child(xx).value where xx is the index
      number or object name of the node, For example :-<br>
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; js1.Child(0).Value&nbsp; // return
      '11'<br>
      &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; js1.Child(0).Value&nbsp; // return
      '11'</p>
    <p> Take note that value property is of string data within double quotes. To
      get the value in the original type, we can use the AsNumber, AsBoolean,
      and AsString property which will return the value, respectively,&nbsp; as
      double, boolean or string (within single quote) type. For example, <br>
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;js1.Child(0).AsNumber&nbsp; //
      returns 11<br>
      &nbsp;&nbsp;&nbsp;
      &nbsp;&nbsp;&nbsp;js2.Child(1).Child('Name').AsString&nbsp; //return
      'Mike'</p>
    <p><b><span style="color: #ff6666;">BE CAREFUL </span></b>of the AsXXX
      properties: If the node is not of XXX type, its value will be cleared and
      its type changed to XXX&nbsp; whenever AsXXX is called. Say the a
      TJsonNode has an integer value of 123, then in the following example&nbsp;
      the AsString will first converted to node to nkString (string type) with
      null value (because it is originally not nkString type). Thus ss is equal
      to '' after assignment. <br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ss := node.AsString; </p>
    <br>
    <b>II. Write/Set node value</b> <br>
    <p> Node value can be changed/assigned as follows: </p>
    <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; js1.Child(0).AsNumber := 999; <br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; js1.Child(0).AsString := 'xyz';<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; js1.Child(0).AsBoolean:= false;</p>
    <p>AsNumber, AsString, AsBoolean will connvert/clear&nbsp; the node to
      nkNumber. nkString. nkBoolean respectively if the original node is not of
      the same kind (data type).<br>
    </p>
    <p style="text-align: right;"> <a href="index.html" title="Top"><img src="top.png"
          alt="Top of page" style="align:right;width:22px;height:22px;"> Top</a>
      <a href="index.html" title="Back to index page"><img src="back_main.png" alt="Back to index page"
          style="align:right;width:20px;height:20px;"> Index</a></p>
  </body>
</html>
